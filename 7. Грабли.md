##Грабли которые не обходит CoffeeScript

JavaScript это страшный зверь. Знать где разбросаны грабли, на которые кто-то уже наступал не менее важно, чем знать как правильно пользоваться языком. Как говорил [Сунь-Цзы][0]: "знай своего врага", и это именно то, о чем пойдет речь в этой главе. Мы рассмотрим темную сторону JavaScript и обратим внимание на все грабли разложенные для ничего не подозревающих разработчиков.

Как уже было написано во введении, изюминка CoffeeScript не только в его лаконичном синтаксисе, но и в его способности обойти  некоторые шероховатости JavaScript. Однако, в связи с тем, что CoffeeScript лишь транслируется в JavaScript, а не запускается в виртуальной машине или интерпретаторе, язык не является панацеей от всех опасностей и неожиданностей JavaScript, и есть еще ряд вещей, о которых Вы должны знать.

####Подмножество JavaScript

####Глобальные переменные
По умолчанию, Javascript код выполняется в глобальной области видимости. Там же находятся и все созданные переменные. Если вы хотите создать переменную в локальной области видимости, нужно явно указывать это с помощью ключевого слова `var`.

```javascript
usersCount = 1;        // Global
var groupsCount = 2;   // Global

(function(){              
  pagesCount = 3;      // Global
  var postsCount = 4;  // Local
})()
```

Это решение кажется немного странным, так как в подавляющем большинстве случаев вы будете создавать локальные, а не глобальные переменные. Так почему бы не сделать это по умолчанию? В нынешнем виде разработчики должны все время помнить об использовании ключевого слова `var` перед объявлением любой переменной, или они столкнуться со странными багами, из-за того, что переменные будут случайно конфликтовать и перезаписывать друг друга.

??
К счастью, Coffeescript приходит на помощь, полностью уничтожая присваивание неявных глобальных переменных. Другими словами, ключевое слово `var` является зарезервированным в Coddeescript, и его использование вызовет синтаксическую ошибку. Локальные переменные создаются неявными по умолчанию, и вам придется попотеть, чтобы создать глобальную переменную без явного указания ее, как свойства `window`.
??

Взгляните на пример присваивания значения переменной в Coffeescript:

```coffeescript
outerScope = true
do ->
  innerScope = true
```

Компилируется в:

```javascript
var outerScope;
outerScope = true;
(function() {
  var innerScope;
  return innerScope = true;
})();
```

Обратите внимание, что в Coffeescript переменные автоматически инициализируются в том контексте, в котором они используются впервые. Несмотря на то, что ??shadow?? внешнюю переменную, вы все еще имеете доступ к ней и можете на нее ссылаться. Однако, будьте осторожны. Вам придется следить за тем, чтобы случайно не переиспользовать имена внешних переменных, особенно когда вы пишите функции или классы с высокой вложенностью. В примере ниже мы случайно перезаписываем переменнную `package` в методе класса:

```coffeescript
package = require('./package')

class Hem
  build: ->
    # Overwrites outer variable!
    package = @hemPackage.compile()

  hemPackage: ->
    package.create()
```

Иногда возникает необходимость использовать глобальные переменные. Вы можете создать их, задавая свойства объекту `window`:

```coffeescript
  class window.Asset
    constructor: ->
```

Гарантируя, что глобальные переменные создаются только явно, Coffescript избавляет нас от одной из самых распространенных ошибок в программах, написанных на Javascript.

####Точка с запятой

####Зарезервированные слова

####Равенства

####Определение функции

####Свойства чисел

##Недоисправленные вещи

####Использование eval

####Использование typeof

####Использование instanceof

####Использование delete

####Использование parseInt

####Строгий режим (Strict mode)

####Изменения в "строгом режиме"

####Использование "строгого режима"

####JavaScript Lint

[0]: https://en.wikipedia.org/wiki/Sun_Tzu
